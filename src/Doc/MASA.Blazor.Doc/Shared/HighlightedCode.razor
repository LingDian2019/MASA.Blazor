@using MASA.Blazor.Doc.Highlight

<pre class="language-@Language">
<code class="language-@Language">
@sourceCode
        </code>
    </pre>

@inject IPrismHighlighter Highlighter

@code {

    [Parameter]
    public string Code { get; set; }

    [Parameter]
    public string Language { get; set; }

    [Parameter]
    public bool CanLoad { get; set; }

    MarkupString sourceCode { get; set; }

    bool hasLoaded = false;

    protected override void OnAfterRender(bool firstRender)
    {
        if (CanLoad && !hasLoaded)
        {
            _ = Task.Run(async () =>
                {
                    sourceCode = await Highlighter.HighlightAsync(Code, Language);//TODO：加载完成通知组件刷新
                    hasLoaded = true;
                    await InvokeAsync(StateHasChanged);
                });
        }
    }

}
